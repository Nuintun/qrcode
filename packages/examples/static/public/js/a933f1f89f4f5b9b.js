!function(){"use strict";function e(e,{x:t,y:s,moduleSize:n},o){e.save(),e.fillStyle=o,e.beginPath(),e.arc(t,s,.5*n,0,2*Math.PI),e.closePath(),e.fill(),e.restore()}function t(e,t,s,n){e.save(),e.lineWidth=1,e.lineCap="square",e.lineJoin="miter",e.strokeStyle=s;const[o]=t,{length:f}=t;e.beginPath(),e.moveTo(o.x,o.y);for(let s=1;s<f;s++){const{x:n,y:o}=t[s];e.lineTo(n,o)}n&&e.closePath(),e.stroke(),e.restore()}self.addEventListener("message",(({data:s})=>{const{image:n,items:o}=s,f=new OffscreenCanvas(n.width,n.height),a=f.getContext("2d");a.drawImage(n,0,0);for(const{timing:s,corners:n,finder:f,alignment:i}of o)t(a,n,"#00ff00",!0),t(a,[f[2],f[0],f[1]],"#ff0000"),t(a,[s[2],s[0],s[1]],"#00ff00"),e(a,f[0],"#ff0000"),e(a,f[1],"#00ff00"),e(a,f[2],"#0000ff"),null!=i&&e(a,i,"#ff00ff");f.convertToBlob().then((e=>{const t={type:"ok",payload:URL.createObjectURL(e)};self.postMessage(t)}),(()=>{self.postMessage({type:"error",message:"生成未知定位图失败"})}))}))}();